/* ===== Общие компоненты ===== */
.card { border:1px solid #e5e7eb; border-radius:12px; background:#fff; padding:12px; }
.btnPrimary{display:inline-flex;align-items:center;justify-content:center;height:36px;padding:0 14px;border-radius:10px;border:1px solid #8d2828;background:#8d2828;color:#fff;font-size:14px;cursor:pointer}
.btnPrimary:disabled{opacity:.7;cursor:default}
.btnDanger{display:inline-flex;align-items:center;justify-content:center;height:32px;padding:0 12px;border-radius:10px;border:1px solid #7f1d1d;background:#fff;color:#7f1d1d}
.statusBadge{display:inline-flex;align-items:center;height:22px;padding:0 10px;border-radius:9999px;font-size:12px;border:1px solid #e5e7eb;background:#fff}
.status-new{border-color:#bfdbfe;background:#eff6ff}
.status-in_progress{border-color:#fde68a;background:#fffbeb}
.status-done{border-color:#bbf7d0;background:#f0fdf4}
.status-rejected{border-color:#fecaca;background:#fef2f2}

/* ===== Страница чата заявки ===== */
:root{ --chat-max:720px }            /* ширина шапки/окна/композера */
@media (max-width:768px){ :root{ --chat-max:100% } }

.reqChatPage{display:grid;grid-template-rows:auto 1fr auto;gap:12px;min-height:calc(100vh - 24px)}

/* одна ширина для шапки, ленты и композера */
.chatHeader.card,.chatWindow.card,.composer.card{width:min(var(--chat-max),100%);margin-inline:auto}

/* Шапка */
.chatHeader{position:sticky;top:0;z-index:2}
.chatHeaderRow{display:flex;align-items:center;justify-content:space-between;gap:12px}
.chatHeaderRight{display:flex;align-items:center;gap:8px}
.chatTitle{margin:0;font-size:20px;font-weight:700;line-height:1.2}
.chatMeta{margin-top:6px;font-size:12px;color:#6b7280}

/* Окно чата */
.chatWindow{display:flex;flex-direction:column;gap:8px;padding:12px;overflow:auto;background:#fff;border-radius:12px}
.emptyMuted{color:#6b7280;font-size:13px;text-align:center;padding:16px 0}

/* Разделитель дат */
.dateDivider{display:flex;justify-content:center;margin:6px 0}
.dateDivider>span{font-size:12px;color:#6b7280;background:#f3f4f6;border:1px solid #e5e7eb;border-radius:9999px;padding:2px 8px}

/* Пузыри */
.msg{
  max-width:min(54%, 500px);    /* уже, читабельнее на десктопе */
  margin:3px 0;
  padding:8px 12px 16px;
  font-size:14px; line-height:1.4;
  position:relative;
  overflow-wrap:anywhere;       /* ломаем длинные слова/URL */
  word-break:break-word;
  hyphens:auto;                 /* красивее переносы, если браузер умеет */
  box-shadow:0 1px 0 rgba(0,0,0,.04);
}
@media (max-width: 640px){
  .msg{ max-width:82%; }        /* на узких экранчиках чуть шире */
}

.msg-peer{ align-self:flex-start; background:#eef2f7; color:#111827; border-radius:16px 16px 16px 6px; margin-right:auto; }
.msg-me  { align-self:flex-end;   background:#8d2828; color:#fff;   border-radius:16px 16px 6px 16px; margin-left:auto; }

.msgHead{ font-size:12px; font-weight:600; margin-bottom:2px; color:#374151; }
.msg-me .msgHead{ display:none; }
.msgBody{ white-space:pre-wrap; }

/* время внутри пузыря */
.msgTime{ position:absolute; bottom:2px; right:8px; font-size:11px; line-height:1; color:rgba(0,0,0,.45); }
.msg-me .msgTime{ color:rgba(255,255,255,.75); }



/* Время внизу справа */
.msgTime{position:absolute;bottom:2px;right:8px;font-size:11px;line-height:1;color:rgba(0,0,0,.45)}
.msg-me .msgTime{color:rgba(255,255,255,.75)}

/* Системное (первое) сообщение */
.msg-system{
  align-self:center;max-width:min(80%,600px);
  background:#fff;border:1px dashed #e5e7eb;border-radius:12px;color:#374151
}
.msg-system .msgTime{position:static;display:block;text-align:right;margin-top:4px;font-size:11px;color:#6b7280}

/* Композер */
.composer { padding: 8px; position: sticky; bottom: 0; z-index: 2; }
.composerForm { display: grid; grid-template-columns: 1fr auto; gap: 8px; align-items: end; }

/* авто-рост: высота задаётся скриптом, здесь — рамки и поведение */
.composerInput{
  width:100%;
  border:1px solid #e5e7eb; border-radius:10px;
  padding:10px 12px;
  font:inherit;
  min-height:44px;           /* 1 строка */
  max-height:160px;          /* ~6–7 строк, дальше скролл */
  overflow:auto;             /* когда больше max-height */
  resize:none;               /* убираем ручной маркер */
  background:#fff;
  line-height:1.4;
}
.composerInput:focus{ outline:none; border-color:#8d2828; box-shadow:0 0 0 3px rgba(141,40,40,.12); }
.composerSend{ height:44px; padding:0 16px; border-radius:10px; width:auto; white-space:nowrap; }


/* ===== Список заявок и форма создания (как было) ===== */
.req-page{display:grid;grid-template-columns:1fr 360px;gap:12px;align-items:start}
@media (max-width:1100px){.req-page{grid-template-columns:1fr}}
.left,.right{min-width:0}
.reqList{display:grid;gap:8px}
.reqRow{display:grid;gap:4px;padding:10px 12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;text-decoration:none;color:inherit}
.reqRow:hover{background:#f9fafb;border-color:#d1d5db}
.reqRowTop{display:flex;align-items:center;justify-content:space-between;gap:8px}
.reqRowTitle{font-weight:600;font-size:14px;line-height:1.3;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;min-width:0}
.reqRowSub{display:flex;align-items:center;gap:6px;color:#6b7280;font-size:12px}
.subItem{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.dot{opacity:.7}
.createForm{display:grid;gap:12px}
.field{display:grid;gap:6px}
.label{font-size:13px;color:#374151}
.input,.textarea{display:block;width:100%;box-sizing:border-box;border:1px solid #e5e7eb;border-radius:8px;padding:8px;font:inherit;background:#fff}
.textarea{resize:vertical;min-height:96px}
.input:focus,.textarea:focus{outline:none;border-color:#8d2828;box-shadow:0 0 0 3px rgba(141,40,40,.12)}
/* Мини-бейдж адресата в списке */
.miniBadge {
  display: inline-flex;
  align-items: center;
  height: 20px;
  padding: 0 8px;
  border-radius: 9999px;
  font-size: 12px;
  font-weight: 600;
  border: 1px solid #e5e7eb;
  background: #fff;
  line-height: 1;
}

.miniBadge.target-deputy {
  color: #8d2828;                 /* фирменный бордовый */
  border-color: #f3c5c5;
  background: #fdf2f2;
}

.miniBadge.target-sysadmin {
  color: #1d4ed8;                 /* синий */
  border-color: #c7d2fe;
  background: #eff6ff;
}
